set ob_query_timeout=1000000000;
drop database if exists et_test;
create database et_test;
use et_test;
set recyclebin = 0;
create external table file_csv_stu (
sid     int,
name    varchar(32),
cls     int
) external_url='/home/chenbochuan.cbc/data/px/stu.csv';
create external table file_csv_teacher (
tid        int,
name       varchar(32),
subject    varchar(4)
) external_url='/home/chenbochuan.cbc/data/px/teacher.csv';
create external table file_csv_score (
sid     int,
subject varchar(4),
score   int
) external_url='/home/chenbochuan.cbc/data/px/score.csv';
create external table oss_csv_stu (
sid     int,
name    varchar(32),
cls     int
) external_url='oss://external-table/px/stu.csv?host=oss-cn-hangzhou.aliyuncs.com&access_id=DEscLTAIStR9ccJJGQFHEaP2&access_key=bhdegy7AqfsFLj]2YpolgMjyTFVZNhK', external_protocal='oss';
create external table oss_csv_teacher (
tid        int,
name       varchar(32),
subject    varchar(4)
) external_url='oss://external-table/px/teacher.csv?host=oss-cn-hangzhou.aliyuncs.com&access_id=DEscLTAIStR9ccJJGQFHEaP2&access_key=bhdegy7AqfsFLj]2YpolgMjyTFVZNhK', external_protocal='oss';
create external table oss_csv_score (
sid     int,
subject varchar(4),
score   int
) external_url='oss://external-table/px/score.csv?host=oss-cn-hangzhou.aliyuncs.com&access_id=DEscLTAIStR9ccJJGQFHEaP2&access_key=bhdegy7AqfsFLj]2YpolgMjyTFVZNhK', external_protocal='oss';
create external table file_tok_stu (
sid     int,
name    varchar(32),
cls     int
) external_url='/home/chenbochuan.cbc/data/px/stu.tok', external_format='tok';
create external table file_tok_teacher (
tid        int,
name       varchar(32),
subject    varchar(4)
) external_url='/home/chenbochuan.cbc/data/px/teacher.tok', external_format='tok';
create external table file_tok_score (
sid     int,
subject varchar(4),
score   int
) external_url='/home/chenbochuan.cbc/data/px/score.tok', external_format='tok';
create external table oss_tok_stu (
sid     int,
name    varchar(32),
cls     int
) external_url='oss://external-table/px/stu.tok?host=oss-cn-hangzhou.aliyuncs.com&access_id=DEscLTAIStR9ccJJGQFHEaP2&access_key=bhdegy7AqfsFLj]2YpolgMjyTFVZNhK', external_protocal='oss', external_format='tok';
create external table oss_tok_teacher (
tid        int,
name       varchar(32),
subject    varchar(4)
) external_url='oss://external-table/px/teacher.tok?host=oss-cn-hangzhou.aliyuncs.com&access_id=DEscLTAIStR9ccJJGQFHEaP2&access_key=bhdegy7AqfsFLj]2YpolgMjyTFVZNhK', external_protocal='oss', external_format='tok';
create external table oss_tok_score (
sid     int,
subject varchar(4),
score   int
) external_url='oss://external-table/px/score.tok?host=oss-cn-hangzhou.aliyuncs.com&access_id=DEscLTAIStR9ccJJGQFHEaP2&access_key=bhdegy7AqfsFLj]2YpolgMjyTFVZNhK', external_protocal='oss', external_format='tok';
select * from file_csv_stu, file_csv_score where file_csv_stu.sid = file_csv_score.sid order by file_csv_score.score;
sid	name	cls	sid	subject	score
11	'a1'	1	11	'EN'	60
11	'a1'	1	11	'MA'	60
12	'b1'	1	12	'EN'	70
12	'b1'	1	12	'MA'	70
13	'c1'	1	13	'EN'	80
13	'c1'	1	13	'MA'	80
21	'a2'	2	21	'EN'	58
21	'a2'	2	21	'MA'	58
22	'b2'	2	22	'EN'	90
22	'b2'	2	22	'MA'	90
31	'a3'	3	31	'EN'	80
31	'a3'	3	31	'MA'	80
41	'a4'	4	41	'EN'	80
41	'a4'	4	41	'MA'	80
42	'b4'	4	42	'EN'	90
42	'b4'	4	42	'MA'	90
51	'a5'	5	51	'EN'	89
51	'a5'	5	51	'MA'	89
52	'b5'	5	52	'EN'	99
52	'b5'	5	52	'MA'	99
61	'a6'	6	61	'EN'	100
61	'a6'	6	61	'MA'	100
62	'b6'	6	62	'EN'	90
62	'b6'	6	62	'MA'	90
63	'c6'	6	63	'EN'	99
63	'c6'	6	63	'MA'	99
64	'd6'	6	64	'EN'	87
64	'd6'	6	64	'MA'	87
select * from oss_csv_stu, oss_csv_score where oss_csv_stu.sid = oss_csv_score.sid order by oss_csv_score.score;
sid	name	cls	sid	subject	score
11	'a1'	1	11	'EN'	60
11	'a1'	1	11	'MA'	60
12	'b1'	1	12	'EN'	70
12	'b1'	1	12	'MA'	70
13	'c1'	1	13	'EN'	80
13	'c1'	1	13	'MA'	80
21	'a2'	2	21	'EN'	58
21	'a2'	2	21	'MA'	58
22	'b2'	2	22	'EN'	90
22	'b2'	2	22	'MA'	90
31	'a3'	3	31	'EN'	80
31	'a3'	3	31	'MA'	80
41	'a4'	4	41	'EN'	80
41	'a4'	4	41	'MA'	80
42	'b4'	4	42	'EN'	90
42	'b4'	4	42	'MA'	90
51	'a5'	5	51	'EN'	89
51	'a5'	5	51	'MA'	89
52	'b5'	5	52	'EN'	99
52	'b5'	5	52	'MA'	99
61	'a6'	6	61	'EN'	100
61	'a6'	6	61	'MA'	100
62	'b6'	6	62	'EN'	90
62	'b6'	6	62	'MA'	90
63	'c6'	6	63	'EN'	99
63	'c6'	6	63	'MA'	99
64	'd6'	6	64	'EN'	87
64	'd6'	6	64	'MA'	87
select * from file_tok_stu, file_tok_score where file_tok_stu.sid = file_tok_score.sid order by file_tok_score.score;
sid	name	cls	sid	subject	score
11	'a1'	1	11	'EN'	60
11	'a1'	1	11	'MA'	60
12	'b1'	1	12	'EN'	70
12	'b1'	1	12	'MA'	70
13	'c1'	1	13	'EN'	80
13	'c1'	1	13	'MA'	80
21	'a2'	2	21	'EN'	58
21	'a2'	2	21	'MA'	58
22	'b2'	2	22	'EN'	90
22	'b2'	2	22	'MA'	90
31	'a3'	3	31	'EN'	80
31	'a3'	3	31	'MA'	80
41	'a4'	4	41	'EN'	80
41	'a4'	4	41	'MA'	80
42	'b4'	4	42	'EN'	90
42	'b4'	4	42	'MA'	90
51	'a5'	5	51	'EN'	89
51	'a5'	5	51	'MA'	89
52	'b5'	5	52	'EN'	99
52	'b5'	5	52	'MA'	99
61	'a6'	6	61	'EN'	100
61	'a6'	6	61	'MA'	100
62	'b6'	6	62	'EN'	90
62	'b6'	6	62	'MA'	90
63	'c6'	6	63	'EN'	99
63	'c6'	6	63	'MA'	99
64	'd6'	6	64	'EN'	87
64	'd6'	6	64	'MA'	87
select * from oss_tok_stu, oss_tok_score where oss_tok_stu.sid = oss_tok_score.sid order by oss_tok_score.score;
sid	name	cls	sid	subject	score
11	'a1'	1	11	'EN'	60
11	'a1'	1	11	'MA'	60
12	'b1'	1	12	'EN'	70
12	'b1'	1	12	'MA'	70
13	'c1'	1	13	'EN'	80
13	'c1'	1	13	'MA'	80
21	'a2'	2	21	'EN'	58
21	'a2'	2	21	'MA'	58
22	'b2'	2	22	'EN'	90
22	'b2'	2	22	'MA'	90
31	'a3'	3	31	'EN'	80
31	'a3'	3	31	'MA'	80
41	'a4'	4	41	'EN'	80
41	'a4'	4	41	'MA'	80
42	'b4'	4	42	'EN'	90
42	'b4'	4	42	'MA'	90
51	'a5'	5	51	'EN'	89
51	'a5'	5	51	'MA'	89
52	'b5'	5	52	'EN'	99
52	'b5'	5	52	'MA'	99
61	'a6'	6	61	'EN'	100
61	'a6'	6	61	'MA'	100
62	'b6'	6	62	'EN'	90
62	'b6'	6	62	'MA'	90
63	'c6'	6	63	'EN'	99
63	'c6'	6	63	'MA'	99
64	'd6'	6	64	'EN'	87
64	'd6'	6	64	'MA'	87
