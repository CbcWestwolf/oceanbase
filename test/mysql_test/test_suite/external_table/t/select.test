--source mysql_test/test_suite/external_table/include/load_ext_table.inc

########## from test/mysql_test/test_suite/executor/t/full_join.test

# NLJ
select /*+use_nl(t1 t2)*/ t1.last_name, t2.last_name from ext t1 full join ext t2 on t1.employee_id = t2.employee_id order by t1.employee_id, t2.employee_id;
select /*+use_nl(t1 t2)*/ t1.last_name, t2.last_name from ext t1 full join ext t2 on t1.employee_id = t2.employee_id where t1.employee_id between 361 and 363 order by t1.employee_id, t2.employee_id;

# MJ 
select /*+use_mj(t1 t2)*/ t1.last_name, t2.last_name from ext t1 full join ext t2 on t1.employee_id = t2.employee_id order by t1.employee_id, t2.employee_id;
select /*+use_mj(t1 t2)*/ t1.last_name, t2.last_name from ext t1 full join ext t2 on t1.employee_id = t2.employee_id where t1.employee_id between 361 and 363 order by t1.employee_id, t2.employee_id;

# MJ 
select /*+use_hash(t1 t2)*/ t1.last_name, t2.last_name from ext t1 full join ext t2 on t1.employee_id = t2.employee_id order by t1.employee_id, t2.employee_id;
select /*+use_hash(t1 t2)*/ t1.last_name, t2.last_name from ext t1 full join ext t2 on t1.employee_id = t2.employee_id where t1.employee_id between 361 and 363 order by t1.employee_id, t2.employee_id;

########## from test/mysql_test/test_suite/groupby/t/group_by_basic.test

--sorted_result
select employee_id, sum(employee_id), count(employee_id), avg(employee_id), max(employee_id), min(employee_id) from ext group by employee_id;
--sorted_result
select last_name, sum(employee_id), count(employee_id), avg(employee_id), max(employee_id), min(employee_id) from ext group by job_id;
--sorted_result
select last_name, sum(employee_id), count(employee_id), avg(employee_id), max(employee_id), min(employee_id) from ext group by hire_date;

--sorted_result
select employee_id, job_id, count(hire_date) from ext group by job_id, hire_date;

## group_concat
select group_concat(job_id, hire_date) from ext;
select group_concat(distinct job_id, hire_date) from ext;

########## test/mysql_test/test_suite/join/t/anti_semi_join.test

--echo # ************** 测试anti仅含equal condition的情况 *******
select /*+ USE_NL(t1, t2)*/ * from ext t1 where not exists (select employee_id from ext t2 where t1.employee_id = t2.employee_id);
--echo
select /*+ USE_MERGE(t1, t2)*/ * from ext t1 where not exists (select employee_id from ext t2 where t1.employee_id = t2.employee_id);
--echo
select /*+ USE_HASH(t1, t2)*/ * from ext t1 where not exists (select employee_id from ext t2 where t1.employee_id = t2.employee_id);

